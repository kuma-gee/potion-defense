[gd_scene load_steps=22 format=3 uid="uid://tkk4wdjf6oaf"]

[ext_resource type="Script" uid="uid://8b4vb34b2tth" path="res://obstacles/helper/follow_player.gd" id="1_ak6dn"]
[ext_resource type="Script" uid="uid://dqhmhamr6gwff" path="res://obstacles/enemies/mutant.gd" id="1_f8nr7"]
[ext_resource type="PackedScene" uid="uid://d1it77k88xbrp" path="res://assets/models/zombie_strong/mutant.glb" id="1_rnd1b"]
[ext_resource type="Material" uid="uid://hwi7egx2e8iv" path="res://obstacles/enemies/mutant.tres" id="2_ynqad"]
[ext_resource type="Script" uid="uid://yp8jmq5o37s5" path="res://player/states/state_machine.gd" id="4_x5dnw"]
[ext_resource type="Script" uid="uid://bd8cabvemw6g1" path="res://obstacles/enemies/jump_area.gd" id="4_xlsoj"]
[ext_resource type="Script" uid="uid://b6ak5s0kwtpbg" path="res://obstacles/enemies/jump_attack.gd" id="7_xlsoj"]
[ext_resource type="PackedScene" uid="uid://ljm1s4uvbr4c" path="res://VFX-Stone/Scenes/VFX_Earth_Ring.tscn" id="8_uo61u"]
[ext_resource type="Script" uid="uid://d4nenix06s4w3" path="res://util/CameraShake.gd" id="10_qvkyp"]
[ext_resource type="PackedScene" uid="uid://bfgfb221ebj27" path="res://obstacles/scenes/hit_box.tscn" id="10_r6ogx"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_f8nr7"]
animation = &"Mutant Jump Attack"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_qy6mr"]
animation = &"Mutant Dying"
use_custom_timeline = true
timeline_length = 2.0
stretch_time_scale = true
start_offset = 0.20000000000000284
loop_mode = 0

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_x5dnw"]
animation = &"Mutant Roaring"

[sub_resource type="AnimationNodeOneShot" id="AnimationNodeOneShot_xlsoj"]
filters = ["Armature_004/Skeleton3D:mixamorig_Head", "Armature_004/Skeleton3D:mixamorig_LeftArm", "Armature_004/Skeleton3D:mixamorig_LeftForeArm", "Armature_004/Skeleton3D:mixamorig_LeftShoulder", "Armature_004/Skeleton3D:mixamorig_Neck", "Armature_004/Skeleton3D:mixamorig_RightArm", "Armature_004/Skeleton3D:mixamorig_RightForeArm", "Armature_004/Skeleton3D:mixamorig_RightHand", "Armature_004/Skeleton3D:mixamorig_RightHandIndex1", "Armature_004/Skeleton3D:mixamorig_RightHandIndex2", "Armature_004/Skeleton3D:mixamorig_RightHandIndex3", "Armature_004/Skeleton3D:mixamorig_RightHandPinky1", "Armature_004/Skeleton3D:mixamorig_RightHandPinky2", "Armature_004/Skeleton3D:mixamorig_RightHandPinky3", "Armature_004/Skeleton3D:mixamorig_RightHandThumb1", "Armature_004/Skeleton3D:mixamorig_RightHandThumb2", "Armature_004/Skeleton3D:mixamorig_RightHandThumb3", "Armature_004/Skeleton3D:mixamorig_RightShoulder", "Armature_004/Skeleton3D:mixamorig_Spine1", "Armature_004/Skeleton3D:mixamorig_Spine2"]
fadein_time = 0.2
fadeout_time = 0.2

[sub_resource type="AnimationNodeOneShot" id="AnimationNodeOneShot_ynqad"]
fadein_time = 0.2
fadeout_time = 0.2

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_ynqad"]
animation = &"Mutant Run"
use_custom_timeline = true
timeline_length = 0.8
stretch_time_scale = true
start_offset = 0.0
loop_mode = 1

[sub_resource type="AnimationNodeTransition" id="AnimationNodeTransition_ynqad"]
xfade_time = 0.2
input_0/name = "alive"
input_0/auto_advance = false
input_0/break_loop_at_end = false
input_0/reset = true
input_1/name = "dead"
input_1/auto_advance = false
input_1/break_loop_at_end = false
input_1/reset = true

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_ynqad"]
graph_offset = Vector2(-320, 42)
nodes/output/position = Vector2(1280, 100)
nodes/Run/node = SubResource("AnimationNodeAnimation_ynqad")
nodes/Run/position = Vector2(-160, 80)
"nodes/Jump Attack/node" = SubResource("AnimationNodeAnimation_x5dnw")
"nodes/Jump Attack/position" = Vector2(-220, 300)
nodes/OneShot/node = SubResource("AnimationNodeOneShot_ynqad")
nodes/OneShot/position = Vector2(40, 80)
nodes/Animation/node = SubResource("AnimationNodeAnimation_qy6mr")
nodes/Animation/position = Vector2(720, 320)
nodes/Transition/node = SubResource("AnimationNodeTransition_ynqad")
nodes/Transition/position = Vector2(1020, 60)
"nodes/OneShot 2/node" = SubResource("AnimationNodeOneShot_xlsoj")
"nodes/OneShot 2/position" = Vector2(480, 100)
"nodes/Animation 2/node" = SubResource("AnimationNodeAnimation_f8nr7")
"nodes/Animation 2/position" = Vector2(200, 300)
node_connections = [&"output", 0, &"Transition", &"OneShot", 0, &"Run", &"OneShot", 1, &"Jump Attack", &"Transition", 0, &"OneShot 2", &"Transition", 1, &"Animation", &"OneShot 2", 0, &"OneShot", &"OneShot 2", 1, &"Animation 2"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_ynqad"]
radius = 0.34277344
height = 1.5310059

[sub_resource type="CylinderShape3D" id="CylinderShape3D_x5dnw"]
height = 1.5
radius = 10.0

[sub_resource type="CylinderShape3D" id="CylinderShape3D_ct8xv"]
radius = 3.5

[node name="Mutant" type="CharacterBody3D" node_paths=PackedStringArray("body") groups=["enemy"]]
collision_layer = 0
script = ExtResource("1_f8nr7")
body = NodePath("Body")

[node name="AttackTimer" type="Timer" parent="."]
wait_time = 3.0
autostart = true

[node name="AnimationTree" type="AnimationTree" parent="."]
root_node = NodePath("../Body/mutant")
tree_root = SubResource("AnimationNodeBlendTree_ynqad")
anim_player = NodePath("../Body/mutant/AnimationPlayer")
parameters/OneShot/active = false
parameters/OneShot/internal_active = false
parameters/OneShot/request = 0
parameters/Transition/current_state = "alive"
parameters/Transition/transition_request = ""
parameters/Transition/current_index = 0
"parameters/OneShot 2/active" = false
"parameters/OneShot 2/internal_active" = false
"parameters/OneShot 2/request" = 0

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.76854986, 0.18805313)
shape = SubResource("CapsuleShape3D_ynqad")

[node name="Body" type="Node3D" parent="."]

[node name="mutant" parent="Body" instance=ExtResource("1_rnd1b")]
transform = Transform3D(-1, 0, -8.742278e-08, 0, 1, 0, 8.742278e-08, 0, -1, 0, 0, 0)

[node name="Skeleton3D" parent="Body/mutant/Armature_004" index="0"]
bones/0/position = Vector3(-0.00021585006, 4.9201385e-12, 4.1273113e-05)
bones/1/position = Vector3(1.8237797e-07, 0.81440735, 0.045524996)
bones/1/rotation = Quaternion(0.17440067, -0.041263994, -0.00025495293, 0.9838097)
bones/2/rotation = Quaternion(0.21760643, 0.044397082, 0.025915576, 0.974682)
bones/3/rotation = Quaternion(0.10010552, -0.012480066, 0.042893793, 0.9939735)
bones/4/rotation = Quaternion(0.17972904, -0.010068826, 0.037605163, 0.98294556)
bones/5/rotation = Quaternion(-0.42013296, 0.121663675, -0.15778963, 0.8853185)
bones/6/rotation = Quaternion(-0.052718725, -0.127365, 0.08240662, 0.9870198)
bones/8/rotation = Quaternion(0.51876396, 0.50828743, -0.50778717, 0.46333584)
bones/9/rotation = Quaternion(0.29985902, -0.030615497, 0.24359888, 0.9218497)
bones/10/rotation = Quaternion(-1.6203494e-05, 1.2509007e-06, 0.4306534, 0.90251744)
bones/12/rotation = Quaternion(0.5013358, -0.511516, 0.4951391, 0.49178368)
bones/13/rotation = Quaternion(0.16079952, 0.25152263, -0.36595705, 0.8814507)
bones/14/rotation = Quaternion(-1.9883002e-05, -2.510477e-06, -0.3821311, 0.9241082)
bones/15/rotation = Quaternion(0.18515098, 0.3112603, -0.16068713, 0.918159)
bones/16/rotation = Quaternion(-0.026258662, -0.0034021195, 0.06255913, 0.99768996)
bones/17/rotation = Quaternion(0.22165024, 4.3443032e-07, -0.00033533204, 0.97512615)
bones/18/rotation = Quaternion(0.19675083, -0.0006686575, -0.03049993, 0.97997886)
bones/20/rotation = Quaternion(-0.062803976, 0.70306736, 0.025668679, 0.70787936)
bones/21/rotation = Quaternion(0.00033584077, 7.861867e-08, 0.22165038, 0.97512615)
bones/22/rotation = Quaternion(0.00016255621, -4.3088615e-08, 0.1072835, 0.9942285)
bones/24/rotation = Quaternion(0.22126031, -0.29773846, -0.44436327, 0.8154367)
bones/25/rotation = Quaternion(-0.250871, -0.024907205, 0.3056754, 0.9181536)
bones/26/rotation = Quaternion(-0.18344232, -0.010673947, 0.1821757, 0.96594363)
bones/28/rotation = Quaternion(0.0776418, 0.49166864, 0.8670885, -0.019782765)
bones/29/rotation = Quaternion(-0.64947146, -0.029825874, 0.030185271, 0.759201)
bones/30/rotation = Quaternion(0.5074507, -0.012013721, -0.027775932, 0.86114925)
bones/31/rotation = Quaternion(0.5581383, -0.008639818, 0.002204053, 0.82970005)
bones/33/rotation = Quaternion(-0.12324767, 0.3209923, 0.9388639, 0.01756937)
bones/34/rotation = Quaternion(-0.48873106, -0.17108071, 0.11514181, 0.8477121)
bones/35/rotation = Quaternion(0.66191816, -0.06345262, -0.113635816, 0.7381904)
bones/36/rotation = Quaternion(0.43737397, -9.241233e-06, 1.9817602e-05, 0.89927965)

[node name="MutantMesh" parent="Body/mutant/Armature_004/Skeleton3D" index="0"]
surface_material_override/0 = ExtResource("2_ynqad")

[node name="JumpArea" type="Area3D" parent="."]
collision_layer = 0
collision_mask = 2
script = ExtResource("4_xlsoj")

[node name="JumpTimerCooldown" type="Timer" parent="JumpArea"]
wait_time = 10.0
one_shot = true

[node name="CollisionShape3D" type="CollisionShape3D" parent="JumpArea"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.8674216, 0)
shape = SubResource("CylinderShape3D_x5dnw")

[node name="StateMachine" type="Node" parent="." node_paths=PackedStringArray("initial_state")]
script = ExtResource("4_x5dnw")
initial_state = NodePath("FollowPlayer")
metadata/_custom_type_script = "uid://yp8jmq5o37s5"

[node name="FollowPlayer" type="Node" parent="StateMachine" node_paths=PackedStringArray("character_body")]
script = ExtResource("1_ak6dn")
follow_speed = 2.0
acceleration = 5.0
max_distance = 100.0
stop_distance = 0.0
character_body = NodePath("../..")
metadata/_custom_type_script = "uid://8b4vb34b2tth"

[node name="JumpAttack" type="Node" parent="StateMachine" node_paths=PackedStringArray("enemy", "hit_area", "camera_shake")]
script = ExtResource("7_xlsoj")
enemy = NodePath("../..")
vfx_scene = ExtResource("8_uo61u")
hit_area = NodePath("../../HitBox")
camera_shake = NodePath("CameraShake")
metadata/_custom_type_script = "uid://g325vyi3fud1"

[node name="CameraShake" type="Node" parent="StateMachine/JumpAttack"]
script = ExtResource("10_qvkyp")
metadata/_custom_type_script = "uid://d4nenix06s4w3"

[node name="LandRecover" type="Timer" parent="StateMachine/JumpAttack"]
wait_time = 3.0
one_shot = true

[node name="HitBox" parent="." instance=ExtResource("10_r6ogx")]
force = 20.0

[node name="CollisionShape3D2" type="CollisionShape3D" parent="HitBox"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.81209254, 0)
shape = SubResource("CylinderShape3D_ct8xv")

[editable path="Body/mutant"]
