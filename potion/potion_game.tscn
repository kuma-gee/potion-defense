[gd_scene load_steps=32 format=3 uid="uid://bquyk6n7heynp"]

[ext_resource type="Script" uid="uid://clcoqwyyr1mau" path="res://potion/potion_game.gd" id="1_1w3wt"]
[ext_resource type="Script" uid="uid://b8r3wk16v6bq7" path="res://potion/items/item_resource.gd" id="2_jjj4w"]
[ext_resource type="Script" uid="uid://bh2kij0kebasu" path="res://potion/enemy/resources/enemy_resource.gd" id="3_16d2i"]
[ext_resource type="Resource" uid="uid://61d6yq6b1l8q" path="res://potion/items/resources/red_herb.tres" id="3_41urv"]
[ext_resource type="Resource" uid="uid://c3mcqueui0db2" path="res://potion/items/resources/charcoal.tres" id="4_41urv"]
[ext_resource type="Resource" uid="uid://b8ujitv2y52po" path="res://potion/enemy/resources/mage_resource.tres" id="4_rmnmn"]
[ext_resource type="PackedScene" uid="uid://lym0kep4xafw" path="res://potion/maps/map_0.tscn" id="5_1w3wt"]
[ext_resource type="Resource" uid="uid://di67w6t0nqyiv" path="res://potion/enemy/resources/rogue_resource.tres" id="5_ux70s"]
[ext_resource type="Resource" uid="uid://qbua8j5nrtkt" path="res://potion/enemy/resources/skeleton_resource.tres" id="6_kfjfp"]
[ext_resource type="Resource" uid="uid://bawmjv8tyfdjy" path="res://potion/enemy/resources/warrior_resource.tres" id="7_e2yce"]
[ext_resource type="Texture2D" uid="uid://d3k27mbvpdxc3" path="res://assets/items/Items_IceShard.png" id="17_8mtc6"]
[ext_resource type="PackedScene" uid="uid://bjemhxyjs5ne6" path="res://player/fps_player.tscn" id="17_ho6vn"]
[ext_resource type="Script" uid="uid://d4dbk8ol8tvjc" path="res://potion/wave_manager.gd" id="19_fqivl"]
[ext_resource type="Script" uid="uid://hvt4yogrf1dd" path="res://potion/ui/gameover_screen.gd" id="20_kavja"]
[ext_resource type="Script" uid="uid://p37xhunyyh2r" path="res://potion/ui/wave_setup.gd" id="22_1w3wt"]
[ext_resource type="PackedScene" uid="uid://cgva0jspdrkae" path="res://potion/ui/item_button.tscn" id="23_1w3wt"]
[ext_resource type="Script" uid="uid://j5po78o2gfbr" path="res://potion/ui/player_join.gd" id="24_8mtc6"]
[ext_resource type="Script" uid="uid://cy4rv80rahocd" path="res://potion/ui/unlocked_item.gd" id="25_16d2i"]
[ext_resource type="AudioStream" uid="uid://8a8a1i5eannm" path="res://assets/sound/Apparitionâ€™s_Lullaby.mp3" id="25_rmnmn"]
[ext_resource type="Shader" uid="uid://bckxauf6c0xpr" path="res://shader/circle_rainbow.gdshader" id="29_e2yce"]
[ext_resource type="Script" uid="uid://dx61xjyqwyuhi" path="res://potion/ui/recipe_book_ui.gd" id="34_bo5nf"]
[ext_resource type="Texture2D" uid="uid://w8xwxpot3wg1" path="res://assets/recipes/Page_1.png" id="36_33pbe"]
[ext_resource type="Texture2D" uid="uid://cf1qeyh63xxdj" path="res://assets/recipes/Page_2.png" id="37_v3yac"]
[ext_resource type="Texture2D" uid="uid://bjsvlfsh166j6" path="res://assets/recipes/Page_3.png" id="38_8yxqf"]
[ext_resource type="Script" uid="uid://b8p0l6hclg7fb" path="res://potion/ui/pause.gd" id="39_v3yac"]

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_v3yac"]
bg_color = Color(0.32172796, 0.32172796, 0.32172787, 1)

[sub_resource type="Gradient" id="Gradient_e2yce"]
offsets = PackedFloat32Array(0, 0.31034482)
colors = PackedColorArray(1, 0.9333334, 0, 1, 0, 0, 0, 0)

[sub_resource type="GradientTexture1D" id="GradientTexture1D_077x5"]
gradient = SubResource("Gradient_e2yce")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_077x5"]
shader = ExtResource("29_e2yce")
shader_parameter/speed = 1.0
shader_parameter/count = 7.005
shader_parameter/strength = 7.54
shader_parameter/smoothing = -0.66
shader_parameter/size = 1.7
shader_parameter/color_gradient = SubResource("GradientTexture1D_077x5")

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_33pbe"]
bg_color = Color(0.8866618, 0.83570474, 0.8183721, 1)

[sub_resource type="Environment" id="Environment_f4yaa"]
background_mode = 1

[node name="PotionBase" type="Node3D" node_paths=PackedStringArray("map_root", "player_root", "wave_manager", "wave_setup", "unlocked_item", "pause", "recipe_ui")]
script = ExtResource("1_1w3wt")
initial_items = Array[ExtResource("2_jjj4w")]([ExtResource("3_41urv"), ExtResource("4_41urv")])
map_root = NodePath("MapRoot")
map_scene = ExtResource("5_1w3wt")
player_root = NodePath("PlayerRoot")
wave_manager = NodePath("WaveManager")
wave_setup = NodePath("CanvasLayer/Control/WaveSetup")
unlocked_item = NodePath("CanvasLayer/Control/UnlockedItem")
pause = NodePath("CanvasLayer/Control/Pause")
recipe_ui = NodePath("CanvasLayer/Control/Recipes")

[node name="WaveManager" type="Node" parent="." node_paths=PackedStringArray("enemy_spawn_root", "wave_label", "spawn_timer", "wave_timer")]
script = ExtResource("19_fqivl")
enemy_spawn_root = NodePath("../EnemiesRoot")
wave_label = NodePath("../CanvasLayer/Wave")
spawn_enemy_count = 50
enemy_resources = Array[ExtResource("3_16d2i")]([ExtResource("6_kfjfp"), ExtResource("5_ux70s"), ExtResource("7_e2yce"), ExtResource("4_rmnmn")])
spawn_timer = NodePath("SpawnTimer")
wave_timer = NodePath("WaveTimer")
metadata/_custom_type_script = "uid://d4dbk8ol8tvjc"

[node name="SpawnTimer" type="Timer" parent="WaveManager"]

[node name="WaveTimer" type="Timer" parent="WaveManager"]
wait_time = 10.0
one_shot = true

[node name="EnemiesRoot" type="Node3D" parent="."]

[node name="MapRoot" type="Node3D" parent="."]

[node name="PlayerRoot" type="Node3D" parent="."]

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="Wave" type="Label" parent="CanvasLayer"]
anchors_preset = 5
anchor_left = 0.5
anchor_right = 0.5
offset_left = -21.5
offset_right = 21.5
offset_bottom = 23.0
grow_horizontal = 2
text = "Wave"

[node name="Control" type="Control" parent="CanvasLayer"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2

[node name="Gameover" type="ColorRect" parent="CanvasLayer/Control" node_paths=PackedStringArray("restart_btn")]
visible = false
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0, 0, 0, 0.50980395)
script = ExtResource("20_kavja")
restart_btn = NodePath("CenterContainer/VBoxContainer/Restart")

[node name="CenterContainer" type="CenterContainer" parent="CanvasLayer/Control/Gameover"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="VBoxContainer" type="VBoxContainer" parent="CanvasLayer/Control/Gameover/CenterContainer"]
layout_mode = 2

[node name="Label" type="Label" parent="CanvasLayer/Control/Gameover/CenterContainer/VBoxContainer"]
layout_mode = 2
text = "Gameover"

[node name="Restart" type="Button" parent="CanvasLayer/Control/Gameover/CenterContainer/VBoxContainer"]
layout_mode = 2
text = "Restart"

[node name="WaveSetup" type="ColorRect" parent="CanvasLayer/Control" node_paths=PackedStringArray("item_select_grid", "selected_items_container", "ingredient_label", "finish_button")]
visible = false
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0, 0, 0, 0.50980395)
script = ExtResource("22_1w3wt")
item_select_grid = NodePath("WaveSetup/PanelContainer/VBoxContainer/HBoxContainer/GridContainer")
selected_items_container = NodePath("WaveSetup/PanelContainer/VBoxContainer/HBoxContainer/VBoxContainer")
item_button_scene = ExtResource("23_1w3wt")
ingredient_label = NodePath("WaveSetup/PanelContainer/VBoxContainer/HBoxContainer/Label")
finish_button = NodePath("WaveSetup/PanelContainer/VBoxContainer/HBoxContainer2/Next")

[node name="WaveSetup" type="CenterContainer" parent="CanvasLayer/Control/WaveSetup"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 0

[node name="PanelContainer" type="PanelContainer" parent="CanvasLayer/Control/WaveSetup/WaveSetup"]
custom_minimum_size = Vector2(300, 500)
layout_mode = 2
theme_override_styles/panel = SubResource("StyleBoxFlat_v3yac")

[node name="VBoxContainer" type="VBoxContainer" parent="CanvasLayer/Control/WaveSetup/WaveSetup/PanelContainer"]
layout_mode = 2

[node name="HBoxContainer" type="VBoxContainer" parent="CanvasLayer/Control/WaveSetup/WaveSetup/PanelContainer/VBoxContainer"]
layout_mode = 2
size_flags_vertical = 3

[node name="GridContainer" type="GridContainer" parent="CanvasLayer/Control/WaveSetup/WaveSetup/PanelContainer/VBoxContainer/HBoxContainer"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
columns = 5

[node name="Label" type="Label" parent="CanvasLayer/Control/WaveSetup/WaveSetup/PanelContainer/VBoxContainer/HBoxContainer"]
layout_mode = 2

[node name="VBoxContainer" type="HBoxContainer" parent="CanvasLayer/Control/WaveSetup/WaveSetup/PanelContainer/VBoxContainer/HBoxContainer"]
layout_mode = 2
size_flags_horizontal = 3

[node name="HBoxContainer2" type="HBoxContainer" parent="CanvasLayer/Control/WaveSetup/WaveSetup/PanelContainer/VBoxContainer"]
layout_mode = 2

[node name="Next" type="Button" parent="CanvasLayer/Control/WaveSetup/WaveSetup/PanelContainer/VBoxContainer/HBoxContainer2"]
layout_mode = 2
size_flags_horizontal = 3
text = "Next Wave"

[node name="Recipes" type="Button" parent="CanvasLayer/Control/WaveSetup/WaveSetup/PanelContainer/VBoxContainer/HBoxContainer2"]
layout_mode = 2
text = " Recipes "

[node name="UnlockedItem" type="ColorRect" parent="CanvasLayer/Control" node_paths=PackedStringArray("texture_rect", "label")]
visible = false
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0, 0, 0, 0.50980395)
script = ExtResource("25_16d2i")
texture_rect = NodePath("CenterContainer/VBoxContainer/TextureRect")
label = NodePath("CenterContainer/VBoxContainer/Label")

[node name="CenterContainer" type="CenterContainer" parent="CanvasLayer/Control/UnlockedItem"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="ColorRect" type="ColorRect" parent="CanvasLayer/Control/UnlockedItem/CenterContainer"]
visible = false
material = SubResource("ShaderMaterial_077x5")
custom_minimum_size = Vector2(300, 300)
layout_mode = 2

[node name="VBoxContainer" type="VBoxContainer" parent="CanvasLayer/Control/UnlockedItem/CenterContainer"]
layout_mode = 2
theme_override_constants/separation = 16

[node name="Label2" type="Label" parent="CanvasLayer/Control/UnlockedItem/CenterContainer/VBoxContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 32
text = "UNLOCKED"
horizontal_alignment = 1

[node name="TextureRect" type="TextureRect" parent="CanvasLayer/Control/UnlockedItem/CenterContainer/VBoxContainer"]
custom_minimum_size = Vector2(0, 128)
layout_mode = 2
texture = ExtResource("17_8mtc6")
expand_mode = 2
stretch_mode = 5

[node name="Label" type="Label" parent="CanvasLayer/Control/UnlockedItem/CenterContainer/VBoxContainer"]
layout_mode = 2
text = "Test"
horizontal_alignment = 1

[node name="Recipes" type="ColorRect" parent="CanvasLayer/Control" node_paths=PackedStringArray("recipe_page", "next_page_btn", "prev_page_btn", "page_label")]
visible = false
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0, 0, 0, 0.50980395)
script = ExtResource("34_bo5nf")
recipe_page = NodePath("CenterContainer/PanelContainer/VBoxContainer/MarginContainer/TextureRect")
next_page_btn = NodePath("CenterContainer/PanelContainer/VBoxContainer/HBoxContainer/Next")
prev_page_btn = NodePath("CenterContainer/PanelContainer/VBoxContainer/HBoxContainer/Prev")
page_label = NodePath("CenterContainer/PanelContainer/VBoxContainer/HBoxContainer/Page")
recipes = Array[Texture2D]([ExtResource("36_33pbe"), ExtResource("37_v3yac"), ExtResource("38_8yxqf")])

[node name="CenterContainer" type="CenterContainer" parent="CanvasLayer/Control/Recipes"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="PanelContainer" type="PanelContainer" parent="CanvasLayer/Control/Recipes/CenterContainer"]
custom_minimum_size = Vector2(300, 500)
layout_mode = 2
theme_override_styles/panel = SubResource("StyleBoxFlat_33pbe")

[node name="VBoxContainer" type="VBoxContainer" parent="CanvasLayer/Control/Recipes/CenterContainer/PanelContainer"]
layout_mode = 2

[node name="MarginContainer" type="MarginContainer" parent="CanvasLayer/Control/Recipes/CenterContainer/PanelContainer/VBoxContainer"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3

[node name="TextureRect" type="TextureRect" parent="CanvasLayer/Control/Recipes/CenterContainer/PanelContainer/VBoxContainer/MarginContainer"]
layout_mode = 2
texture = ExtResource("36_33pbe")
expand_mode = 3
stretch_mode = 5

[node name="HBoxContainer" type="HBoxContainer" parent="CanvasLayer/Control/Recipes/CenterContainer/PanelContainer/VBoxContainer"]
layout_mode = 2

[node name="Prev" type="Button" parent="CanvasLayer/Control/Recipes/CenterContainer/PanelContainer/VBoxContainer/HBoxContainer"]
visible = false
layout_mode = 2
size_flags_vertical = 8
text = "Prev"

[node name="Page" type="Label" parent="CanvasLayer/Control/Recipes/CenterContainer/PanelContainer/VBoxContainer/HBoxContainer"]
layout_mode = 2
size_flags_horizontal = 3
theme_override_constants/outline_size = 5
text = "0/0"
horizontal_alignment = 1

[node name="Next" type="Button" parent="CanvasLayer/Control/Recipes/CenterContainer/PanelContainer/VBoxContainer/HBoxContainer"]
visible = false
layout_mode = 2
size_flags_vertical = 8
text = "Next"

[node name="Pause" type="ColorRect" parent="CanvasLayer/Control" node_paths=PackedStringArray("game", "continue_btn", "restart_btn")]
visible = false
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0, 0, 0, 0.50980395)
script = ExtResource("39_v3yac")
game = NodePath("../../..")
continue_btn = NodePath("CenterContainer/VBoxContainer/Continue")
restart_btn = NodePath("CenterContainer/VBoxContainer/Restart")

[node name="CenterContainer" type="CenterContainer" parent="CanvasLayer/Control/Pause"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="VBoxContainer" type="VBoxContainer" parent="CanvasLayer/Control/Pause/CenterContainer"]
layout_mode = 2

[node name="Label" type="Label" parent="CanvasLayer/Control/Pause/CenterContainer/VBoxContainer"]
layout_mode = 2
text = "Paused"
horizontal_alignment = 1

[node name="Continue" type="Button" parent="CanvasLayer/Control/Pause/CenterContainer/VBoxContainer"]
layout_mode = 2
text = "Continue"

[node name="Restart" type="Button" parent="CanvasLayer/Control/Pause/CenterContainer/VBoxContainer"]
layout_mode = 2
text = "Restart"

[node name="PlayerJoin" type="ColorRect" parent="CanvasLayer/Control" node_paths=PackedStringArray("game", "start_btn", "player_root", "joined_label")]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0, 0, 0, 0.50980395)
script = ExtResource("24_8mtc6")
game = NodePath("../../..")
start_btn = NodePath("CenterContainer/VBoxContainer2/Start")
player_root = NodePath("../../../PlayerRoot")
player_scene = ExtResource("17_ho6vn")
joined_label = NodePath("CenterContainer/VBoxContainer2/Joined")

[node name="CenterContainer" type="CenterContainer" parent="CanvasLayer/Control/PlayerJoin"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="VBoxContainer2" type="VBoxContainer" parent="CanvasLayer/Control/PlayerJoin/CenterContainer"]
layout_mode = 2

[node name="Label" type="Label" parent="CanvasLayer/Control/PlayerJoin/CenterContainer/VBoxContainer2"]
layout_mode = 2
text = "Press button to join"

[node name="Joined" type="Label" parent="CanvasLayer/Control/PlayerJoin/CenterContainer/VBoxContainer2"]
layout_mode = 2
text = "Joined"

[node name="Start" type="Button" parent="CanvasLayer/Control/PlayerJoin/CenterContainer/VBoxContainer2"]
layout_mode = 2
text = "Start"

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_f4yaa")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(0.49999997, 0.86602545, 0, 0.33318624, -0.19236514, 0.923029, 0.7993666, -0.46151447, -0.3847303, 0, 7.925477, 0)
light_energy = 0.4
metadata/_edit_lock_ = true

[node name="BGM" type="AudioStreamPlayer" parent="."]
stream = ExtResource("25_rmnmn")
volume_db = -25.0
autoplay = true

[connection signal="game_over" from="WaveManager" to="CanvasLayer/Control/Gameover" method="show_gameover"]
[connection signal="pressed" from="CanvasLayer/Control/WaveSetup/WaveSetup/PanelContainer/VBoxContainer/HBoxContainer2/Recipes" to="CanvasLayer/Control/Recipes" method="grab_focus"]
